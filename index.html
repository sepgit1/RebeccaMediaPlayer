<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebecca Media Player</title>
    
    <script>
        // Check if user is authenticated
        if (sessionStorage.getItem('musicPlayerAuthenticated') !== 'true') {
            window.location.href = 'login.html';
        }
    </script>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Rebecca's elegant and futuristic media player with up to 500 songs and videos">
    <meta name="theme-color" content="#ff1493">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Rebecca Media Player">
    <!-- Cache bust: 2025-10-26-v5 -->
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" sizes="192x192" href="icons/icon-192x192.svg">
    <link rel="apple-touch-icon" href="icons/icon-192x192.svg">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css?v=2025-10-26-v5">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Rebecca Media Player</h1>
            <div class="header-right">
                <div class="user-info">
                    <span id="userName">User</span>
                </div>
                <div class="song-counter">
                    <span id="songCount">0</span> / 500 items
                </div>
                <button id="settingsBtn" class="settings-btn" title="Settings">âš™ï¸</button>
            </div>
        </header>

        <!-- Animated Visualizer -->
        <div class="visualizer-container">
            <div class="visualizer" id="visualizer">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
        </div>

        <!-- Video Player (Hidden by default) -->
        <div id="videoContainer" class="video-container" style="display: none;">
            <video id="videoPlayer" controls>
                Your browser does not support the video tag.
            </video>
        </div>

        <!-- Music Controls -->
        <div class="player-section">
            <div class="current-song">
                <div class="song-art">
                    <div class="music-note" id="mediaIcon">ğŸµ</div>
                </div>
                <div class="song-info">
                    <h2 id="currentSongTitle">No song selected</h2>
                    <p id="currentSongArtist">Select a song to start playing</p>
                </div>
            </div>

            <div class="controls">
                <button id="prevBtn" class="control-btn">â®ï¸</button>
                <button id="playPauseBtn" class="control-btn play-pause">â–¶ï¸</button>
                <button id="nextBtn" class="control-btn">â­ï¸</button>
                <button id="shuffleBtn" class="control-btn">ğŸ”€</button>
                <button id="repeatBtn" class="control-btn">ğŸ”</button>
                <button id="updateBtn" class="control-btn" title="Update App">ğŸ”„</button>
                <button id="ccBtn" class="control-btn" title="Closed Captions">CC</button>
            </div>

            <!-- Closed Captions Display -->
            <div id="ccDisplay" class="cc-display" style="display: none;">
                <div class="cc-text" id="ccText">Captions appear here...</div>
                <button id="closeCcBtn" class="close-cc-btn">âœ•</button>
            </div>

        </div>

        <!-- Comments Section -->
        <div class="comments-section">
            <h3>ğŸ’¬ Comments</h3>
            <div class="add-comment">
                <textarea id="commentInput" class="comment-input" placeholder="Share your thoughts about this song..."></textarea>
                <button id="postCommentBtn" class="post-comment-btn">ğŸ’¬ Post Comment</button>
            </div>
            <div id="commentsList" class="comments-list">
                <p class="no-comments">No comments yet. Be the first to comment!</p>
            </div>
        </div>

        <!-- File Upload Section -->
        <div class="upload-section" id="dropZone">
            <label for="fileInput" class="upload-btn">
                ğŸ“ Add Songs or Videos
                <input type="file" id="fileInput" accept="audio/*,video/*" multiple style="display: none;">
            </label>
            <p class="drop-hint">ğŸ’¡ Or drag & drop files here</p>
            <button id="clearAllBtn" class="clear-btn">ğŸ—‘ï¸ Clear All Songs</button>
        </div>

        <!-- Playlist Section -->
        <div class="playlist-section">
            <h3>ğŸ“‹ My Playlist</h3>
            <div class="playlist-controls">
                <input type="text" id="searchInput" placeholder="ğŸ” Search songs..." class="search-input">
                <select id="sortSelect" class="sort-select">
                    <option value="name">Sort by Name</option>
                    <option value="artist">Sort by Artist</option>
                    <option value="date">Sort by Date Added</option>
                </select>
            </div>
            <ul id="playlist" class="playlist"></ul>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state">
            <div class="empty-icon">ğŸ¶</div>
            <h3>Your playlist is empty!</h3>
            <p>Add some songs to get started</p>
        </div>
    </div>

    <!-- Audio Element -->
    <audio id="audioPlayer" preload="metadata"></audio>

    <!-- Install PWA Prompt -->
    <div id="installPrompt" class="install-prompt" style="display: none;">
        <div class="install-content">
            <h3>ï¿½ Install Rebecca Media Player</h3>
            <p>Add this elegant app to your home screen for quick access!</p>
            <div class="install-buttons">
                <button id="installBtn" class="install-btn-yes">Install</button>
                <button id="dismissBtn" class="install-btn-no">Not now</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="settings-modal" style="display: none;">
        <div class="settings-modal-content">
            <div class="settings-header">
                <h2>âš™ï¸ Settings</h2>
                <button id="closeSettingsBtn" class="close-btn">âœ•</button>
            </div>
            
            <div class="settings-section">
                <label>ğŸŒ“ Theme</label>
                <div class="theme-options">
                    <button class="theme-btn" data-theme="light" title="Light Mode">â˜€ï¸</button>
                    <button class="theme-btn" data-theme="dark" title="Dark Mode">ğŸŒ™</button>
                    <button class="theme-btn" data-theme="auto" title="Auto Mode">ğŸ”„</button>
                </div>
            </div>

            <div class="settings-section">
                <label>ğŸ¨ Color Scheme</label>
                <div class="color-options">
                    <button class="color-btn" data-color="pink" title="Pink" style="background: linear-gradient(135deg, #ff1493, #ff69b4);"></button>
                    <button class="color-btn" data-color="purple" title="Purple" style="background: linear-gradient(135deg, #8b00ff, #d946ef);"></button>
                    <button class="color-btn" data-color="blue" title="Blue" style="background: linear-gradient(135deg, #0066ff, #00d4ff);"></button>
                    <button class="color-btn" data-color="green" title="Green" style="background: linear-gradient(135deg, #00b894, #55efc4);"></button>
                    <button class="color-btn" data-color="orange" title="Orange" style="background: linear-gradient(135deg, #ff7f50, #ffa500);"></button>
                    <button class="color-btn" data-color="red" title="Red" style="background: linear-gradient(135deg, #ff0000, #ff4444);"></button>
                </div>
            </div>

            <div class="settings-section">
                <label>ğŸµ Other Options</label>
                <div class="toggle-option">
                    <span>Enable Animations</span>
                    <input type="checkbox" id="animationsToggle" class="toggle-checkbox">
                </div>
                <button id="updateSettingsBtn" class="update-btn">âœ“ Update Settings</button>
            </div>

            <!-- Privacy & Safety Section -->
            <div class="settings-section privacy-section">
                <label>ğŸ”’ Privacy & Safety</label>
                <div class="privacy-info">
                    <p><strong>Rebecca's Safety is Our Priority</strong></p>
                    <ul>
                        <li>âœ… No location tracking or GPS</li>
                        <li>âœ… No personal data collection</li>
                        <li>âœ… No geolocation services</li>
                        <li>âœ… Local storage only</li>
                        <li>âœ… All data stays on this device</li>
                        <li>âœ… No third-party tracking</li>
                        <li>âœ… Completely private & secure</li>
                    </ul>
                    <p style="margin-top: 10px; font-size: 0.85rem; color: rgba(255, 255, 255, 0.7);">
                        This app respects your privacy. No external services track your activity.
                    </p>
                </div>
            </div>

            <!-- Admin Panel (Hidden by default) -->
            <div id="adminPanel" class="admin-panel" style="display: none;">
                <div class="admin-divider"></div>
                <div class="admin-header">
                    <h3>ğŸ‘‘ Admin Controls</h3>
                </div>
                
                <div class="settings-section">
                    <label>ğŸ“Š App Management</label>
                    <div class="admin-buttons">
                        <button id="clearCacheBtn" class="admin-btn">ğŸ§¹ Clear Cache</button>
                        <button id="resetAppBtn" class="admin-btn danger">âš ï¸ Reset App</button>
                    </div>
                </div>

                <div class="settings-section">
                    <label>ğŸ“ˆ Storage Info</label>
                    <div class="storage-info">
                        <p>Songs: <span id="adminSongCount">0</span></p>
                        <p>Storage Used: <span id="adminStorageSize">0 MB</span></p>
                    </div>
                </div>

                <div class="settings-section">
                    <label>ğŸ”„ App Version</label>
                    <p class="version-info">v1.0.0 - Updated 2025-10-26</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="script.js?v=2025-10-26-v5"></script>
</body>
</html>